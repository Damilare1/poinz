
# Poinz Command and Event Docu
This is an autogenerated docu. Sun Jun 07 2020 10:51:16 GMT+0200 (Central European Summer Time)

## Commands

* [addStory](#addStory)
* [changeStory](#changeStory)
* [clearStoryEstimate](#clearStoryEstimate)
* [createRoom](#createRoom)
* [deleteStory](#deleteStory)
* [giveStoryEstimate](#giveStoryEstimate)
* [joinRoom](#joinRoom)
* [kick](#kick)
* [leaveRoom](#leaveRoom)
* [newEstimationRound](#newEstimationRound)
* [reveal](#reveal)
* [selectStory](#selectStory)
* [setEmail](#setEmail)
* [setUsername](#setUsername)
* [toggleExclude](#toggleExclude)


### Command "addStory" <a name="addStory"></a>

[source](/server/src/commandHandlers/addStory.js)

Description

```text
A user adds a story to the estimation backlog of the room
```

Produces

* **[storyAdded](#storyAdded)**
* **[storySelected](#storySelected)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "title": {
                            "type": "string",
                            "minLength": 1
                        },
                        "description": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "title"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "changeStory" <a name="changeStory"></a>

[source](/server/src/commandHandlers/changeStory.js)

Description

```text
A user changes the title and/or description of a story
```

Produces

* **[storyChanged](#storyChanged)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string"
                        },
                        "title": {
                            "type": "string",
                            "minLength": 1
                        },
                        "description": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "title",
                        "description",
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "clearStoryEstimate" <a name="clearStoryEstimate"></a>

[source](/server/src/commandHandlers/clearStoryEstimate.js)

Description

```text
A user clears his estimation value for a certain story.
Users may only clear estimation for the currently selected story.
```

Produces

* **[storyEstimateCleared](#storyEstimateCleared)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "userId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId",
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "createRoom" <a name="createRoom"></a>

[source](/server/src/commandHandlers/createRoom.js)

Description

```text
A user creates a new room
```

Produces

* **[roomCreated](#roomCreated)**
* **[joinedRoom](#joinedRoom)**
* **[usernameSet](#usernameSet)**
* **[emailSet](#emailSet)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        },
                        "username": {
                            "type": "string"
                        },
                        "email": {
                            "type": "string",
                            "format": "email"
                        },
                        "alias": {
                            "type": "string"
                        }
                    },
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "deleteStory" <a name="deleteStory"></a>

[source](/server/src/commandHandlers/deleteStory.js)

Description

```text
A user deletes a story
```

Produces

* **[storyDeleted](#storyDeleted)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "title": {
                            "type": "string",
                            "minLength": 1
                        },
                        "userId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId",
                        "title"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "giveStoryEstimate" <a name="giveStoryEstimate"></a>

[source](/server/src/commandHandlers/giveStoryEstimate.js)

Description

```text
A user gives his estimation for a certain story.
Users may only give estimations for the currently selected story.
A user that is marked as excluded (see toggleExclude/excludedFromEstimations)  cannot give estimations
As soon as all users (that can estimate) estimated the story, a "revealed" event is produced
```

Produces

* **[storyEstimateGiven](#storyEstimateGiven)**
* **[revealed](#revealed)**
* **[consensusAchieved](#consensusAchieved)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "userId": {
                            "type": "string",
                            "minLength": 1
                        },
                        "value": {
                            "type": "number"
                        }
                    },
                    "required": [
                        "storyId",
                        "userId",
                        "value"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "joinRoom" <a name="joinRoom"></a>

[source](/server/src/commandHandlers/joinRoom.js)

Description

```text
A user joins a room.
If the room does not yet exist, a "roomCreated" event is produced.
Produces also a "roomJoined" event (which contains the room state)
```

Produces

* **[joinedRoom](#joinedRoom)**
* **[usernameSet](#usernameSet)**
* **[emailSet](#emailSet)**
* **[excludedFromEstimations](#excludedFromEstimations)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        },
                        "username": {
                            "type": "string"
                        },
                        "email": {
                            "type": "string",
                            "format": "email"
                        }
                    },
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "kick" <a name="kick"></a>

[source](/server/src/commandHandlers/kick.js)

Description

```text
A user removes a disconnected user from the room.
```

Produces

* **[kicked](#kicked)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "leaveRoom" <a name="leaveRoom"></a>

[source](/server/src/commandHandlers/leaveRoom.js)

Description

```text
A user wants to leave the room.
Is also produced by the socketServer itself on connection lost!
```

Produces

* **[connectionLost](#connectionLost)**
* **[leftRoom](#leftRoom)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        },
                        "connectionLost": {
                            "type": "boolean"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "newEstimationRound" <a name="newEstimationRound"></a>

[source](/server/src/commandHandlers/newEstimationRound.js)

Description

```text
A user starts a new estimation round for a certain story.
This will clear all estimations given by users for this story.
This will reset any consensus that might have been achieved previously.
Can only be done for the currently selected story.
```

Produces

* **[newEstimationRoundStarted](#newEstimationRoundStarted)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "reveal" <a name="reveal"></a>

[source](/server/src/commandHandlers/reveal.js)

Description

```text
A user manually reveals estimates for a certain story
Users may only reveal the currently selected story
```

Produces

* **[revealed](#revealed)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "selectStory" <a name="selectStory"></a>

[source](/server/src/commandHandlers/selectStory.js)

Description

```text
A user selected a story (marked it as the "current" story to estimate)
```

Produces

* **[storySelected](#storySelected)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "storyId": {
                            "type": "string",
                            "minLength": 1
                        }
                    },
                    "required": [
                        "storyId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "setEmail" <a name="setEmail"></a>

[source](/server/src/commandHandlers/setEmail.js)

Description

```text
A user sets his email address (used for Gravatar image fetching. See https://en.gravatar.com/ ).
```

Produces

* **[emailSet](#emailSet)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        },
                        "email": {
                            "type": "string",
                            "format": "email"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "setUsername" <a name="setUsername"></a>

[source](/server/src/commandHandlers/setUsername.js)

Description

```text
A user sets his username.
```

Produces

* **[usernameSet](#usernameSet)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        },
                        "username": {
                            "type": "string",
                            "minLength": 2
                        }
                    },
                    "required": [
                        "userId",
                        "username"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

### Command "toggleExclude" <a name="toggleExclude"></a>

[source](/server/src/commandHandlers/toggleExclude.js)

Description

```text
A user can exclude himself from estimations.
Emits event "excludedFromEstimations" or "includedInEstimations"  on toggle
If user is marked as excluded, he cannot estimate stories.
```

Produces

* **[includedInEstimations](#includedInEstimations)**
* **[excludedFromEstimations](#excludedFromEstimations)**

Schema

```json
{
    "allOf": [
        {
            "$ref": "command"
        },
        {
            "properties": {
                "payload": {
                    "type": "object",
                    "properties": {
                        "userId": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "userId"
                    ],
                    "additionalProperties": false
                }
            }
        }
    ]
}
```
 

## Events

* [storyAdded](#storyAdded)
* [storySelected](#storySelected)
* [storyChanged](#storyChanged)
* [storyEstimateCleared](#storyEstimateCleared)
* [roomCreated](#roomCreated)
* [joinedRoom](#joinedRoom)
* [usernameSet](#usernameSet)
* [emailSet](#emailSet)
* [storyDeleted](#storyDeleted)
* [storyEstimateGiven](#storyEstimateGiven)
* [revealed](#revealed)
* [consensusAchieved](#consensusAchieved)
* [excludedFromEstimations](#excludedFromEstimations)
* [kicked](#kicked)
* [connectionLost](#connectionLost)
* [leftRoom](#leftRoom)
* [newEstimationRoundStarted](#newEstimationRoundStarted)
* [includedInEstimations](#includedInEstimations)


### Event "storyAdded" <a name="storyAdded"></a>

[source](/server/src/eventHandlers/storyAdded.js)

produced by command(s): [addStory](#addStory)

Description

```text

```

   

### Event "storySelected" <a name="storySelected"></a>

[source](/server/src/eventHandlers/storySelected.js)

produced by command(s): [addStory](#addStory), [selectStory](#selectStory)

Description

```text

```

   

### Event "storyChanged" <a name="storyChanged"></a>

[source](/server/src/eventHandlers/storyChanged.js)

produced by command(s): [changeStory](#changeStory)

Description

```text

```

   

### Event "storyEstimateCleared" <a name="storyEstimateCleared"></a>

[source](/server/src/eventHandlers/storyEstimateCleared.js)

produced by command(s): [clearStoryEstimate](#clearStoryEstimate)

Description

```text

```

   

### Event "roomCreated" <a name="roomCreated"></a>

[source](/server/src/eventHandlers/roomCreated.js)

produced by command(s): [createRoom](#createRoom)

Description

```text

```

   

### Event "joinedRoom" <a name="joinedRoom"></a>

[source](/server/src/eventHandlers/joinedRoom.js)

produced by command(s): [createRoom](#createRoom), [joinRoom](#joinRoom)

Description

```text

```

   

### Event "usernameSet" <a name="usernameSet"></a>

[source](/server/src/eventHandlers/usernameSet.js)

produced by command(s): [createRoom](#createRoom), [joinRoom](#joinRoom), [setUsername](#setUsername)

Description

```text

```

   

### Event "emailSet" <a name="emailSet"></a>

[source](/server/src/eventHandlers/emailSet.js)

produced by command(s): [createRoom](#createRoom), [joinRoom](#joinRoom), [setEmail](#setEmail)

Description

```text

```

   

### Event "storyDeleted" <a name="storyDeleted"></a>

[source](/server/src/eventHandlers/storyDeleted.js)

produced by command(s): [deleteStory](#deleteStory)

Description

```text

```

   

### Event "storyEstimateGiven" <a name="storyEstimateGiven"></a>

[source](/server/src/eventHandlers/storyEstimateGiven.js)

produced by command(s): [giveStoryEstimate](#giveStoryEstimate)

Description

```text

```

   

### Event "revealed" <a name="revealed"></a>

[source](/server/src/eventHandlers/revealed.js)

produced by command(s): [giveStoryEstimate](#giveStoryEstimate), [reveal](#reveal)

Description

```text
Estimations for the given story were revealed.
This happens automatically if all users that can estimate (not marked as excluded, not disconnected) did estimate the current story (i.e. if the last user gives his estimate)
This happens if a user manually reveals. (this is helpful, if someone is AFK and team wants to proceed with the estimation meeting)
```

   

### Event "consensusAchieved" <a name="consensusAchieved"></a>

[source](/server/src/eventHandlers/consensusAchieved.js)

produced by command(s): [giveStoryEstimate](#giveStoryEstimate)

Description

```text

```

   

### Event "excludedFromEstimations" <a name="excludedFromEstimations"></a>

[source](/server/src/eventHandlers/excludedFromEstimations.js)

produced by command(s): [joinRoom](#joinRoom), [toggleExclude](#toggleExclude)

Description

```text

```

   

### Event "kicked" <a name="kicked"></a>

[source](/server/src/eventHandlers/kicked.js)

produced by command(s): [kick](#kick)

Description

```text

```

   

### Event "connectionLost" <a name="connectionLost"></a>

[source](/server/src/eventHandlers/connectionLost.js)

produced by command(s): [leaveRoom](#leaveRoom)

Description

```text

```

   

### Event "leftRoom" <a name="leftRoom"></a>

[source](/server/src/eventHandlers/leftRoom.js)

produced by command(s): [leaveRoom](#leaveRoom)

Description

```text

```

   

### Event "newEstimationRoundStarted" <a name="newEstimationRoundStarted"></a>

[source](/server/src/eventHandlers/newEstimationRoundStarted.js)

produced by command(s): [newEstimationRound](#newEstimationRound)

Description

```text

```

   

### Event "includedInEstimations" <a name="includedInEstimations"></a>

[source](/server/src/eventHandlers/includedInEstimations.js)

produced by command(s): [toggleExclude](#toggleExclude)

Description

```text

```

   
 